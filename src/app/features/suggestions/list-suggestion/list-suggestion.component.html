<div class="container py-5">
  <h2 class="text-center mb-5 fw-bold">Liste des suggestions</h2>

  <!-- Barre de recherche -->
  <div class="row justify-content-center mb-5">
    <div class="col-lg-6">
      <input type="text" class="form-control form-control-lg rounded-pill shadow-sm"
             placeholder="Rechercher une suggestion"
             [(ngModel)]="searchTerm">
    </div>
  </div>

  <!-- Cartes des suggestions -->
  <div class="row justify-content-center g-5">
    <div class="col-lg-8" *ngFor="let s of filteredSuggestions">
      <div class="card border-0 shadow-sm" style="border-radius: 25px;">
        <div class="card-body p-5">

          <h5 class="fw-bold text-primary mb-3">{{ s.title }}</h5>
          <p class="text-muted small mb-3">
            {{ s.category }} • {{ s.date | date:'dd MMM yyyy' : '' : 'fr' }}
          </p>
          <p class="text-secondary mb-4">{{ s.description }}</p>

          <div class="d-flex justify-content-between align-items-center">

            <!-- Badge statut -->
            <span class="badge rounded-pill px-4 py-2 fw-bold fs-6"
                  [ngClass]="{
                    'bg-success text-white': s.status === 'acceptee',
                    'bg-danger-subtle text-danger': s.status === 'refusee',
                    'bg-warning-subtle text-dark': s.status === 'en_attente'
                  }">
              {{ s.status === 'acceptee' ? 'ACCEPTÉE' : s.status === 'refusee' ? 'REFUSÉE' : 'EN ATTENTE' }}
            </span>

           <div class="card-footer" *ngIf="suggestion.status !== 'refusee'">
  <button class="btn btn-outline-primary btn-sm me-2" (click)="like(suggestion)">
    Like {{ suggestion.likes || 0 }}
  </button>
  <button class="btn btn-outline-danger btn-sm me-2" (click)="toggleFavorite(suggestion.id)">
    Favoris
  </button>
  <a [routerLink]="[suggestion.id]" class="btn btn-info btn-sm me-2">
    Détails
  </a>
</div>

<!-- BOUTONS ADMIN : visibles tout le temps (même si refusée) -->
<div class="mt-2">
  <small class="text-muted">Admin : changer le statut →</small><br>
  <button class="btn btn-success btn-sm me-2" (click)="setStatus(suggestion.id, 'acceptee')"
          [class.active]="suggestion.status === 'acceptee'">
    Acceptée
  </button>
  <button class="btn btn-danger btn-sm me-2" (click)="setStatus(suggestion.id, 'refusee')"
          [class.active]="suggestion.status === 'refusee'">
    Refusée
  </button>
  <button class="btn btn-warning btn-sm text-dark" (click)="setStatus(suggestion.id, 'en_attente')"
          [class.active]="suggestion.status === 'en_attente'">
    En attente
  </button>
</div>